#!/Users/jamiemcmillan/Library/Caches/pypoetry/virtualenvs/image-processing-7EkzBI9D-py3.10/bin/python
import xarray
from datetime import datetime

ds = xarray.open_zarr(
    "gs://gcp-public-data-arco-era5/ar/full_37-1h-0p25deg-chunk-1.zarr-v3",
    chunks=None,
    storage_options=dict(token="anon"),
)
print(ds.attrs)

now = datetime.now()
valid_time_stop = datetime.strptime(ds.attrs["valid_time_stop"], "%Y-%m-%d")
difference = now - valid_time_stop

print(f"ERA5 is {difference.days} days offset")

